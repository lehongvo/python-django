{% extends 'store/base.html' %}

{% load store_filters %}
{% block title %}{{ site_name }} - Premium E-commerce Platform{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="relative bg-gradient-to-br from-indigo-600 via-purple-600 to-pink-600 overflow-hidden">
    <!-- Background Pattern -->
    <div class="absolute inset-0 opacity-10">
        <div class="absolute inset-0" style="background-image: radial-gradient(circle at 20% 50%, white 0%, transparent 50%), radial-gradient(circle at 80% 80%, white 0%, transparent 50%);"></div>
    </div>
    
    <div class="relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-24 md:py-32">
        <div class="grid lg:grid-cols-2 gap-12 items-center">
            <!-- Left Content -->
            <div class="text-white space-y-8">
                <div class="inline-block bg-white bg-opacity-20 backdrop-blur-sm px-4 py-2 rounded-full mb-4">
                    <span class="text-sm font-semibold flex items-center">
                        <i class="fas fa-check-circle mr-2"></i>Trusted by 50,000+ customers
                    </span>
                </div>
                
                <h1 class="text-5xl md:text-6xl lg:text-7xl font-bold leading-tight">
                    Shop the Best
                    <br><span class="bg-gradient-to-r from-yellow-300 to-pink-300 bg-clip-text text-transparent">Premium Products</span>
                    <br>Online
            </h1>
                
                <p class="text-xl md:text-2xl text-gray-100 max-w-2xl">
                    Discover exceptional quality products with unbeatable prices. 
                    Fast shipping, secure checkout, and 24/7 support.
                </p>
                
                <div class="flex flex-col sm:flex-row gap-4">
                    <a href="{% url 'store:product_list' %}" class="bg-white text-indigo-600 px-8 py-4 rounded-xl font-bold text-lg hover:bg-gray-100 transition-all shadow-2xl flex items-center justify-center">
                        <i class="fas fa-shopping-bag mr-3"></i>Shop Now
                    </a>
                    <a href="{% url 'store:category_list' %}" class="bg-white bg-opacity-10 backdrop-blur-sm border-2 border-white text-white px-8 py-4 rounded-xl font-bold text-lg hover:bg-opacity-20 transition-all flex items-center justify-center">
                        <i class="fas fa-th-large mr-3"></i>Browse Categories
                    </a>
                </div>
                
                <!-- Trust Indicators -->
                <div class="flex flex-wrap gap-6 mt-8">
                    <div class="flex items-center text-white">
                        <div class="bg-white bg-opacity-20 backdrop-blur-sm p-3 rounded-full mr-3">
                            <i class="fas fa-shipping-fast text-2xl"></i>
                        </div>
                        <div>
                            <div class="font-bold text-lg">Free Shipping</div>
                            <div class="text-sm text-gray-200">On orders over $100</div>
                        </div>
                    </div>
                    <div class="flex items-center text-white">
                        <div class="bg-white bg-opacity-20 backdrop-blur-sm p-3 rounded-full mr-3">
                            <i class="fas fa-shield-alt text-2xl"></i>
                        </div>
                        <div>
                            <div class="font-bold text-lg">Secure Payment</div>
                            <div class="text-sm text-gray-200">SSL encrypted</div>
                        </div>
            </div>
        </div>
    </div>
    
            <!-- Right - Featured Product Carousel -->
            {% if featured_products %}
            <div class="relative">
                <div class="absolute inset-0 bg-white rounded-3xl transform rotate-6 scale-105 opacity-20"></div>
                <div class="relative bg-white rounded-3xl shadow-2xl p-8">
                    <!-- Product Carousel -->
                    <div id="productCarousel" class="carousel-container">
                        {% for product in featured_products %}
                        <div class="carousel-item {% if forloop.first %}active{% endif %}" data-product-id="{{ product.id }}">
                            <div class="aspect-square overflow-hidden rounded-2xl mb-6 bg-gradient-to-br from-gray-50 to-gray-100 relative group">
                                {% if product.image %}
                                <img src="{{ product.image.url }}" alt="{{ product.name }}" class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-500">
                                {% else %}
                                <div class="h-full flex items-center justify-center bg-gradient-to-br from-indigo-50 to-purple-50">
                                    <i class="fas fa-image text-6xl text-indigo-300"></i>
                                </div>
                                {% endif %}
                                <!-- Overlay for discount badge -->
                                {% if product.computed_discount_percent > 0 %}
                                <div class="absolute top-4 left-4 bg-red-500 text-white px-3 py-1 rounded-full text-sm font-bold shadow-lg">
                                    {{ product.computed_discount_percent|floatformat:0 }}% OFF
                                </div>
                                {% endif %}
                                <!-- Quick actions overlay -->
                                <div class="absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                                    <div class="opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex space-x-2">
                                        <a href="{% url 'store:product_detail' product.slug %}" class="bg-white text-gray-800 px-4 py-2 rounded-full text-sm font-semibold hover:bg-gray-100 transition-colors">
                                            <i class="fas fa-eye mr-1"></i>Quick View
                                        </a>
                                        <button type="button" onclick="addToCart({{ product.id }})" class="bg-indigo-600 text-white px-4 py-2 rounded-full text-sm font-semibold hover:bg-indigo-700 transition-colors">
                                            <i class="fas fa-shopping-cart mr-1"></i>Add
                                        </button>
                                        <button type="button" data-product-id="{{ product.id }}" class="bg-white text-gray-800 px-4 py-2 rounded-full text-sm font-semibold hover:bg-gray-100 transition-colors add-to-wishlist-btn">
                                            <i class="fas fa-heart mr-1"></i>Wishlist
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div class="space-y-4">
                                <div class="flex items-center gap-2">
                                    {% for i in "12345" %}
                                    <i class="fas fa-star text-yellow-400"></i>
                                    {% endfor %}
                                    <span class="text-gray-600 text-sm ml-2">(4.9) {{ product.stock|add:1000 }}+ reviews</span>
                                </div>
                                <h3 class="text-2xl font-bold text-gray-900 line-clamp-2">{{ product.name }}</h3>
                                <div class="flex items-center justify-between">
                                    <div class="flex items-baseline gap-2">
                                        <span class="text-3xl font-bold text-indigo-600">{{ product.price|format_vnd }}</span>
                                        {% if product.compare_price %}
                                        <span class="text-gray-400 line-through">{{ product.compare_price|format_vnd }}</span>
                                        {% endif %}
                                    </div>
                                    <a href="{% url 'store:product_detail' product.slug %}" class="bg-indigo-600 text-white px-6 py-3 rounded-xl font-bold hover:bg-indigo-700 transition-all transform hover:scale-105">
                                        View Details
                                    </a>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                    
                    <!-- Carousel Indicators -->
                    <div class="flex justify-center space-x-2 mt-6">
                        {% for product in featured_products %}
                        <button class="carousel-indicator w-2 h-2 rounded-full {% if forloop.first %}bg-indigo-600{% else %}bg-gray-300{% endif %} transition-colors" data-slide="{{ forloop.counter0 }}"></button>
                        {% endfor %}
                    </div>
                </div>
    </div>
            {% endif %}
    </div>
    </div>
</section>

<!-- Stats Section -->
<section class="py-20 bg-white border-b border-gray-100">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="grid grid-cols-2 md:grid-cols-4 gap-6">
            <div class="text-center p-6 rounded-2xl bg-gradient-to-br from-indigo-50 to-indigo-100">
                <div class="text-5xl font-bold text-indigo-600 mb-3">{{ featured_products|length }}+</div>
                <div class="text-gray-700 font-semibold">Featured Products</div>
            </div>
            <div class="text-center p-6 rounded-2xl bg-gradient-to-br from-purple-50 to-purple-100">
                <div class="text-5xl font-bold text-purple-600 mb-3">{{ categories|length }}+</div>
                <div class="text-gray-700 font-semibold">Categories</div>
            </div>
            <div class="text-center p-6 rounded-2xl bg-gradient-to-br from-green-50 to-green-100">
                <div class="text-5xl font-bold text-green-600 mb-3">24/7</div>
                <div class="text-gray-700 font-semibold">Support</div>
            </div>
            <div class="text-center p-6 rounded-2xl bg-gradient-to-br from-orange-50 to-orange-100">
                <div class="text-5xl font-bold text-orange-600 mb-3">50K+</div>
                <div class="text-gray-700 font-semibold">Happy Customers</div>
            </div>
        </div>
    </div>
</section>

<!-- Featured Products -->
{% if featured_products %}
<section class="py-20 bg-gray-50">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center mb-16">
            <h2 class="text-4xl font-bold text-gray-900 mb-4 section-title">
                <i class="fas fa-star text-yellow-500 mr-3"></i>Featured Products
            </h2>
            <p class="text-xl text-gray-600 max-w-2xl mx-auto">
                Discover our handpicked selection of premium products, carefully curated for the modern lifestyle.
            </p>
        </div>
        
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
            {% for product in featured_products %}
            <div class="product-card bg-white rounded-2xl shadow-lg overflow-hidden group">
                <!-- Product Image -->
                <div class="relative h-64 bg-gradient-to-br from-gray-50 to-gray-100 flex items-center justify-center overflow-hidden">
                    {% if product.image %}
                    <img src="{{ product.image.url }}" alt="{{ product.name }}" class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-500">
                    {% else %}
                    <div class="text-center">
                        <i class="fas fa-image text-6xl text-indigo-300 mb-4"></i>
                        <p class="text-indigo-500 font-medium">Product Image</p>
                    </div>
                    {% endif %}
                    
                    <!-- Discount Badge -->
                    {% if product.computed_discount_percent > 0 %}
                    <div class="absolute top-4 right-4 bg-red-500 text-white px-3 py-1 rounded-full text-sm font-bold shadow-lg">
                        {{ product.computed_discount_percent|floatformat:0 }}% OFF
                    </div>
                    {% endif %}
                    
                    <!-- Quick Actions -->
                    <div class="absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center opacity-0 group-hover:opacity-100">
                        <div class="flex space-x-2">
                            <a href="{% url 'store:product_detail' product.slug %}" class="bg-white text-gray-900 px-4 py-2 rounded-full font-medium hover:bg-gray-100 transition-colors">
                                <i class="fas fa-eye mr-2"></i>Quick View
                            </a>
                            <button type="button" data-product-id="{{ product.id }}" class="bg-indigo-600 text-white px-4 py-2 rounded-full font-medium hover:bg-indigo-700 transition-colors add-to-wishlist-btn">
                                <i class="fas fa-heart mr-2"></i>Wishlist
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Product Info -->
                <div class="p-6">
                    <div class="flex items-center justify-between mb-2">
                        <span class="text-sm text-indigo-600 font-semibold">{{ product.category.name }}</span>
                        <div class="flex space-x-1">
                            {% for tag in product.tags.all %}
                            <span class="bg-gray-100 text-gray-600 text-xs px-2 py-1 rounded-full">{{ tag.name }}</span>
                            {% endfor %}
                        </div>
                    </div>
                    
                    <h3 class="text-xl font-bold text-gray-900 mb-2 group-hover:text-indigo-600 transition-colors">
                        {{ product.name }}
                    </h3>
                    
                    <p class="text-gray-600 mb-4 line-clamp-2">
                        {{ product.short_description|truncatewords:15 }}
                    </p>
                    
                    <!-- Price -->
                    <div class="flex items-center justify-between mb-4">
                        <div class="flex items-center space-x-2">
                            <span class="text-2xl font-bold text-gray-900">{{ product.price|format_vnd }}</span>
                            {% if product.compare_price %}
                            <span class="text-lg text-gray-500 line-through">{{ product.compare_price|format_vnd }}</span>
                            {% endif %}
                        </div>
                        <div class="flex items-center space-x-1">
                            <i class="fas fa-star text-yellow-400"></i>
                            <i class="fas fa-star text-yellow-400"></i>
                            <i class="fas fa-star text-yellow-400"></i>
                            <i class="fas fa-star text-yellow-400"></i>
                            <i class="fas fa-star text-gray-300"></i>
                            <span class="text-sm text-gray-500 ml-1">(4.0)</span>
                        </div>
                    </div>
                    
                    <!-- Stock Status -->
                    <div class="flex items-center justify-between mb-4">
                        <div class="flex items-center">
                            {% if product.is_in_stock %}
                            <i class="fas fa-check-circle text-green-500 mr-2"></i>
                            <span class="text-green-600 font-medium">In Stock</span>
                            {% else %}
                            <i class="fas fa-times-circle text-red-500 mr-2"></i>
                            <span class="text-red-600 font-medium">Out of Stock</span>
                            {% endif %}
                        </div>
                        <span class="text-sm text-gray-500">{{ product.stock }} available</span>
                    </div>
                    
                    <!-- Actions -->
                    <div class="flex space-x-2">
                        <a href="{% url 'store:product_detail' product.slug %}" 
                           class="flex-1 bg-indigo-600 text-white text-center py-3 rounded-xl font-semibold hover:bg-indigo-700 transition-colors">
                            <i class="fas fa-eye mr-2"></i>View Details
                        </a>
                        {% if product.is_in_stock %}
                        <button class="bg-green-600 text-white px-4 py-3 rounded-xl font-semibold hover:bg-green-700 transition-colors" onclick="addToCart({{ product.id }})">
                            <i class="fas fa-shopping-cart"></i>
                        </button>
                        {% else %}
                        <button class="bg-gray-400 text-white px-4 py-3 rounded-xl font-semibold cursor-not-allowed" disabled>
                            <i class="fas fa-times"></i>
                        </button>
                        {% endif %}
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        
        <div class="text-center mt-12">
            <a href="{% url 'store:product_list' %}" class="btn-modern text-lg px-8 py-4">
                <i class="fas fa-arrow-right mr-2"></i>View All Products
            </a>
        </div>
    </div>
</section>
{% endif %}

<!-- Categories Section -->
{% if categories %}
<section class="py-20 bg-white">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center mb-16">
            <h2 class="text-4xl font-bold text-gray-900 mb-4 section-title">
                <i class="fas fa-th-large text-indigo-500 mr-3"></i>Shop by Category
            </h2>
            <p class="text-xl text-gray-600 max-w-2xl mx-auto">
                Explore our diverse range of categories, each offering unique products tailored to your needs.
            </p>
        </div>
        
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
            {% for category in categories %}
            <div class="group cursor-pointer">
                <div class="bg-gradient-to-br from-indigo-50 to-purple-50 rounded-2xl p-8 text-center hover:shadow-xl transition-all duration-300 transform hover:-translate-y-2">
                    <div class="w-16 h-16 bg-gradient-to-r from-indigo-500 to-purple-600 rounded-full flex items-center justify-center mx-auto mb-6 group-hover:scale-110 transition-transform">
                        <i class="fas fa-{{ category.name|lower|slice:':1' }} text-white text-2xl"></i>
                    </div>
                    
                    <h3 class="text-2xl font-bold text-gray-900 mb-3">{{ category.name }}</h3>
                    <p class="text-gray-600 mb-6">{{ category.description|truncatewords:15 }}</p>
                    
                    <div class="flex items-center justify-center space-x-4 mb-6">
                        <span class="bg-indigo-100 text-indigo-600 px-3 py-1 rounded-full text-sm font-semibold">
                            {{ category.product_set.count }} products
                        </span>
                        <span class="text-gray-500 text-sm">
                            <i class="fas fa-clock mr-1"></i>Updated daily
                        </span>
                    </div>
                    
                    <a href="{% url 'store:product_list' %}?category={{ category.slug }}" 
                       class="inline-flex items-center text-indigo-600 font-semibold hover:text-indigo-700 transition-colors">
                        Browse {{ category.name }}
                        <i class="fas fa-arrow-right ml-2 group-hover:translate-x-1 transition-transform"></i>
                    </a>
                </div>
            </div>
            {% endfor %}
        </div>

        <!-- Category Pagination -->
        <div class="flex justify-between items-center mt-10">
            <div class="text-sm text-gray-600">
                Page {{ cat_page_obj.number }} of {{ cat_paginator.num_pages }}
            </div>
            <div class="flex items-center space-x-2">
                {% if cat_page_obj.has_previous %}
                <a href="?cat_page={{ cat_page_obj.previous_page_number }}&cat_limit={{ cat_limit }}"
                   class="px-4 py-2 bg-white border rounded-xl hover:bg-gray-50">Prev</a>
                {% else %}
                <span class="px-4 py-2 bg-gray-100 border rounded-xl text-gray-400">Prev</span>
                {% endif %}
                {% if cat_page_obj.has_next %}
                <a href="?cat_page={{ cat_page_obj.next_page_number }}&cat_limit={{ cat_limit }}"
                   class="px-4 py-2 bg-white border rounded-xl hover:bg-gray-50">Next</a>
                {% else %}
                <span class="px-4 py-2 bg-gray-100 border rounded-xl text-gray-400">Next</span>
                {% endif %}
            </div>
            <form method="get">
                <input type="hidden" name="cat_page" value="1">
                <label class="text-sm text-gray-600 mr-2">Per row</label>
                <select name="cat_limit" class="px-3 py-2 border rounded-xl" onchange="this.form.submit()">
                    {% for n in cat_limits %}
                    <option value="{{ n }}" {% if cat_limit == n %}selected{% endif %}>{{ n }}</option>
                    {% endfor %}
                </select>
            </form>
        </div>
    </div>
</section>
{% endif %}

<!-- Features Section -->
<section class="py-20 bg-gray-900 text-white">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center mb-16">
            <h2 class="text-4xl font-bold mb-4">
                Why Choose TechStore 2025?
            </h2>
            <p class="text-xl text-gray-300 max-w-2xl mx-auto">
                Experience the next generation of e-commerce with our cutting-edge platform.
            </p>
        </div>
        
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
            <div class="text-center">
                <div class="w-16 h-16 bg-gradient-to-r from-indigo-500 to-purple-600 rounded-full flex items-center justify-center mx-auto mb-6">
                    <i class="fas fa-rocket text-white text-2xl"></i>
                </div>
                <h3 class="text-2xl font-bold mb-4">Lightning Fast</h3>
                <p class="text-gray-300">
                    Experience blazing-fast page loads and instant responses with our optimized platform.
                </p>
            </div>
            
            <div class="text-center">
                <div class="w-16 h-16 bg-gradient-to-r from-green-500 to-blue-600 rounded-full flex items-center justify-center mx-auto mb-6">
                    <i class="fas fa-shield-alt text-white text-2xl"></i>
                </div>
                <h3 class="text-2xl font-bold mb-4">Secure & Safe</h3>
                <p class="text-gray-300">
                    Your data and transactions are protected with enterprise-grade security measures.
                </p>
            </div>
            
            <div class="text-center">
                <div class="w-16 h-16 bg-gradient-to-r from-orange-500 to-red-600 rounded-full flex items-center justify-center mx-auto mb-6">
                    <i class="fas fa-headset text-white text-2xl"></i>
                </div>
                <h3 class="text-2xl font-bold mb-4">24/7 Support</h3>
                <p class="text-gray-300">
                    Get help whenever you need it with our round-the-clock customer support team.
                </p>
            </div>
        </div>
    </div>
</section>

<!-- Newsletter Section - E-commerce Style -->
<section class="bg-gray-900 py-16 md:py-24 relative overflow-hidden">
    <!-- Background Pattern -->
    <div class="absolute inset-0 opacity-10">
        <div class="absolute inset-0" style="background-image: repeating-linear-gradient(45deg, transparent, transparent 10px, rgba(255,255,255,0.05) 10px, rgba(255,255,255,0.05) 20px);"></div>
    </div>
    
    <!-- Gradient Orbs -->
    <div class="absolute top-0 left-0 w-96 h-96 bg-blue-500 rounded-full filter blur-3xl opacity-20"></div>
    <div class="absolute bottom-0 right-0 w-96 h-96 bg-purple-500 rounded-full filter blur-3xl opacity-20"></div>
    
    <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
        <div class="bg-gradient-to-br from-gray-800 to-gray-900 rounded-3xl border border-gray-700 shadow-2xl overflow-hidden">
            <div class="grid md:grid-cols-2 gap-0">
                <!-- Left Side - Content -->
                <div class="p-8 md:p-12 flex flex-col justify-center">
                    <div class="inline-flex items-center gap-2 bg-green-500/10 border border-green-500/30 rounded-full px-4 py-2 mb-6 w-fit">
                        <i class="fas fa-rocket text-green-400"></i>
                        <span class="text-green-400 text-sm font-semibold">Limited Time Offer</span>
                    </div>
                    
                    <h2 class="text-4xl md:text-5xl font-black text-white mb-4 leading-tight">
                        Don't Miss Out on
                        <span class="bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent">
                            Exclusive Deals
                        </span>
                    </h2>
                    
                    <p class="text-gray-300 text-lg mb-8 leading-relaxed">
                        Join 50,000+ subscribers and get access to <strong class="text-white">flash sales</strong>, 
                        <strong class="text-white">new product launches</strong>, and <strong class="text-white">member-only discounts</strong>.
                    </p>
                    
                    <!-- Stats -->
                    <div class="flex flex-wrap gap-6 mb-8">
                        <div class="flex items-center gap-2">
                            <div class="w-2 h-2 bg-green-400 rounded-full animate-pulse"></div>
                            <span class="text-gray-300 text-sm"><strong class="text-white">50K+</strong> Subscribers</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <div class="w-2 h-2 bg-blue-400 rounded-full animate-pulse"></div>
                            <span class="text-gray-300 text-sm"><strong class="text-white">24/7</strong> Support</span>
                        </div>
                    </div>
                    
                    <!-- Trust Badges -->
                    <div class="flex items-center gap-6 text-sm text-gray-400">
                        <div class="flex items-center gap-2">
                            <i class="fas fa-check-circle text-green-400"></i>
                            <span>Instant delivery</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <i class="fas fa-shield-alt text-blue-400"></i>
                            <span>100% Secure</span>
                        </div>
                    </div>
                </div>
                
                <!-- Right Side - Form -->
                <div class="bg-gradient-to-br from-gray-800 to-gray-900 border-l border-gray-700 p-8 md:p-12 flex flex-col justify-center">
                    <form id="newsletter-form">
                        <div class="space-y-4">
                            <div>
                                <label for="newsletter-email" class="block text-sm font-semibold text-gray-300 mb-2">
                                    Email Address
                                </label>
                                <div class="relative">
                                    <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
                                        <i class="fas fa-envelope text-gray-400"></i>
                                    </div>
                                    <input 
                                        type="email" 
                                        id="newsletter-email" 
                                        required
                                        placeholder="you@example.com"
                                        class="block w-full pl-12 pr-4 py-4 border border-gray-600 bg-gray-700/50 text-white placeholder-gray-400 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all">
                                </div>
                            </div>
                            
                            <button 
                                type="submit" 
                                class="w-full bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white font-bold py-4 px-6 rounded-xl transition-all shadow-lg hover:shadow-blue-500/50 transform hover:scale-[1.02] flex items-center justify-center gap-2">
                                <span>Subscribe Now</span>
                                <i class="fas fa-arrow-right"></i>
                </button>
                            
                            <div id="newsletter-message" class="text-center"></div>
                            
                            <p class="text-xs text-gray-500 text-center">
                                <i class="fas fa-lock text-green-400"></i>
                                We respect your privacy. Unsubscribe at any time.
                            </p>
                        </div>
            </form>
                </div>
            </div>
        </div>
    </div>
</section>

<script>
// Get cookie (for CSRF)
function getCookie(name){
    let cookieValue = null;
    if (document.cookie && document.cookie !== '') {
        const cookies = document.cookie.split(';');
        for (let i = 0; i < cookies.length; i++) {
            const cookie = cookies[i].trim();
            if (cookie.substring(0, name.length + 1) === (name + '=')) {
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                break;
            }
        }
    }
    return cookieValue;
}
// Wishlist Buttons
document.addEventListener('DOMContentLoaded', function() {
    const wishlistButtons = document.querySelectorAll('.add-to-wishlist-btn');
    wishlistButtons.forEach(button => {
        button.addEventListener('click', function() {
            const productId = this.getAttribute('data-product-id');
            addToWishlist(productId);
        });
    });
});

// Newsletter Form with Email Validation
document.getElementById('newsletter-form').addEventListener('submit', function(e) {
    e.preventDefault();
    const email = document.getElementById('newsletter-email').value;
    const messageDiv = document.getElementById('newsletter-message');
    const button = this.querySelector('button[type="submit"]');
    const emailInput = document.getElementById('newsletter-email');
    
    // Clear previous messages
    messageDiv.innerHTML = '';
    emailInput.classList.remove('border-red-500', 'border-green-500');
    
    // Email validation regex
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    
    if (!email) {
        messageDiv.innerHTML = '<div class="bg-red-500 text-white px-4 py-2 rounded-lg text-sm"><i class="fas fa-exclamation-circle mr-2"></i>Please enter your email address</div>';
        emailInput.classList.add('border-red-500');
        return;
    }
    
    if (!emailRegex.test(email)) {
        messageDiv.innerHTML = '<div class="bg-red-500 text-white px-4 py-2 rounded-lg text-sm"><i class="fas fa-exclamation-circle mr-2"></i>Please enter a valid email address</div>';
        emailInput.classList.add('border-red-500');
        return;
    }
    
    // Valid email - proceed with subscription
    button.disabled = true;
    button.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Subscribing...';
    
    // Submit to backend
    fetch('/subscribe/', {
        method: 'POST',
        headers: { 
            'Content-Type': 'application/x-www-form-urlencoded',
            'X-CSRFToken': getCookie('csrftoken')
        },
        body: new URLSearchParams({ email })
    }).then(async (res) => {
        const data = await res.json().catch(()=>({}));
        if (res.ok) {
            messageDiv.innerHTML = '<div class="bg-green-500 text-white px-4 py-2 rounded-lg text-sm"><i class="fas fa-check-circle mr-2"></i>' + (data.message || 'Thanks for subscribing!') + '</div>';
            document.getElementById('newsletter-email').value = '';
        } else {
            messageDiv.innerHTML = '<div class="bg-red-500 text-white px-4 py-2 rounded-lg text-sm"><i class="fas fa-exclamation-circle mr-2"></i>' + (data.error || 'Subscription failed') + '</div>';
        }
    }).catch(() => {
        messageDiv.innerHTML = '<div class="bg-red-500 text-white px-4 py-2 rounded-lg text-sm"><i class="fas fa-exclamation-circle mr-2"></i>Subscription failed. Please try again later.</div>';
    }).finally(()=>{
        button.disabled = false;
        button.innerHTML = '<span>Subscribe Now</span><i class="fas fa-arrow-right"></i>';
        setTimeout(()=>{ messageDiv.innerHTML=''; }, 5000);
    });
});

// Real-time email validation
document.getElementById('newsletter-email').addEventListener('input', function() {
    const email = this.value;
    const messageDiv = document.getElementById('newsletter-message');
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    
    if (email.length > 0 && !emailRegex.test(email)) {
        this.classList.add('border-red-500');
        this.classList.remove('border-gray-300');
    } else {
        this.classList.remove('border-red-500');
        this.classList.add('border-gray-300');
        if (messageDiv.innerHTML.includes('red-500')) {
            messageDiv.innerHTML = '';
        }
    }
});

// Product Carousel
document.addEventListener('DOMContentLoaded', function() {
    const carouselItems = document.querySelectorAll('.carousel-item');
    const indicators = document.querySelectorAll('.carousel-indicator');
    let currentSlide = 0;
    
    function showSlide(index) {
        // Hide all slides
        carouselItems.forEach(item => item.classList.remove('active'));
        indicators.forEach(indicator => indicator.classList.remove('active'));
        
        // Show current slide
        if (carouselItems[index]) {
            carouselItems[index].classList.add('active');
        }
        if (indicators[index]) {
            indicators[index].classList.add('active');
        }
        
        currentSlide = index;
    }
    
    function nextSlide() {
        const nextIndex = (currentSlide + 1) % carouselItems.length;
        showSlide(nextIndex);
    }
    
    // Auto-advance every 3 seconds
    setInterval(nextSlide, 3000);
    
    // Manual navigation with indicators
    indicators.forEach((indicator, index) => {
        indicator.addEventListener('click', () => {
            showSlide(index);
        });
    });
});
</script>
{% endblock %}

{% block extra_css %}
<style>
    .line-clamp-2 {
        display: -webkit-box;
        -webkit-line-clamp: 2;
        line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
    }
    
    .animate-fade-in {
        animation: fadeIn 0.6s ease-out;
    }
    
    @keyframes fadeIn {
        from {
            opacity: 0;
            transform: translateY(30px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
    
    /* Carousel Styles */
    .carousel-container {
        position: relative;
        overflow: hidden;
    }
    
    .carousel-item {
        display: none;
        opacity: 0;
        transition: opacity 0.5s ease-in-out;
    }
    
    .carousel-item.active {
        display: block;
        opacity: 1;
    }
    
    .carousel-indicator {
        cursor: pointer;
    }
    
    .carousel-indicator.active {
        background-color: #4f46e5 !important;
    }
</style>
{% endblock %}